# 專案開發訓練-資料工程師-綜合應用

## 訓練目標

- 工作拆分與時程規劃
- 動態網頁爬蟲開發
- API 開發
- pytest 測試框架開發
- 動態網頁渲染練習

## 作答方式

- 題目會提供`功能情境`、`功能需求`，以及`預期產出`，請依照這些基本資訊嘗試進行系統設計，並規劃工作階段與時程
- 請延續使用新人教育訓練的repository

## 期限

- 預計開始時間：2022/11/14
- 預計結束時間：2022/12/02

## review 時間點

- 完成系統規劃後，進行開發前review，須包含預期工作項目與時程 (約rd2同仁)
- 各工作時程到期前 (約rd2同仁)
- 完整系統完成時 (約rd2同仁與各部門主管)
- 想確認程式流程，覺得需要code review時 (約rd2同仁)

## 專案情境及需求

- 專案情境
    - 請撰寫一個租屋網站的爬蟲，並將資料庫儲存下來透過撰寫 API 以及簡易的前端頁面進行呈現

- 撰寫需求
    - 爬蟲需每小時定時執行一次，爬蟲目標及欄位請參照下方 [爬蟲目標及要求](#爬蟲目標及要求)
    - 請使用 mysql 進行資料的儲存，資料庫環境請使用 docker 建立
    - 請撰寫簡易前端頁面，統整爬取到的租屋資料

## 程式架構 (請參考優先順序實作)

1. 請在專案儲存庫當中加入 README.md 描述此專案架構、運作流程、資料格式、如何部屬及執行等
2. 爬蟲程式：每小時爬取新文章，並儲存於資料表中(要能夠長時間執行至少三天)
2. RESTul API：可使用RESTul API介面存取爬到的內容，請利用 FastAPI 進行 Restful API 的開發，提供使用者查詢資料
3. 測試程式：請利用 pytest 替 CRUD 的部分撰寫測試程式
5. 前端：撰寫簡易前端畫面，結合開發出來的 API 進行資料呈現


## 使用套件 (包含但不限於)

請使用以下指定套件開發相應功能：

- 程式語言與套件
    - python 3.8 以上 (包含 3.8)
    - restful API -> [FastAPI](https://fastapi.tiangolo.com/)
    - ORM 架構 -> [SqlAlchemy](https://ithelp.ithome.com.tw/articles/10282664?sc=rss.qu)
    - 資料驗證 -> [Pydantic](https://pydantic-docs.helpmanual.io/)
    - 排程執行 -> [scheduler](https://github.com/dbader/schedule)
    - hint -> FastAPI、SQLAlchemy 與 Pydantic 的結合可參考 [這個連結](https://fastapi.tiangolo.com/tutorial/sql-databases/)

- 資料庫
    - mysql
    - docker

- 測試程式
    - pytest -> [連結](https://ithelp.ithome.com.tw/articles/10291169)

- 流程圖繪圖工具
  - drawio -> [連結](https://www.diagrams.net/)

## 爬蟲目標及要求

- 目標網站
    - [591 租屋網](https://rent.591.com.tw/)
    - [好房網](https://rent.housefun.com.tw/)

- 資料目標
    - 範圍在台北市、新北市的租屋資料

- 資料內容
    - 標題名稱
    - 坪數
    - 樓層
    - 房屋位址
    - 更新時間
    - 每月租金
    - 文章連結

- 爬蟲要求
    - 兩隻爬蟲請一律使用 selenium 進行開發
    - 每小時執行一次爬蟲
    - 爬蟲需要可以穩定執行三天以上 (需有 log 佐證) (log 請存放在資料) (Hint：需要在資料庫當中建立資料表儲存)
    - 租屋資料會不斷更新，請記得判斷哪些資料目前是有在平台上的，並將舊資料進行標記，預設不會顯示在前端上

## Restful API 範例 (包含但不限於)

### 查詢 GET

可藉由api功能查詢爬下來的文章

- `/api/posts` 預設回傳最新的50筆，並且能夠提供分頁（limit, offset），並提供 發文者、發文日期、地區、是否可以被租賃等參數進行查詢
- `/api/posts/<id>` 回傳指定 id 文章詳細資料，id 為資料庫內的 id 非網站上文章 id
- `/api/statistics` 回傳指定條件下的統計資訊，包含文章總數，並提供發文日期、地區等參數進行過濾

### 新增 POST

- `/api/posts` 手動建立一筆租屋資料

### 修改 PUT

- `/api/posts/<id>` 手動修改一筆租屋資料

### 刪除 DELETE

- `/api/posts/<id>` 手動刪除一筆租屋資料

## 加分項目 (請參考優先順序實作，實作情請先找部門同仁討論)

1. 替 FastAPI 也加上測試程式
2. 使用 celery 取代 scheduler 進行任務排程
3. 使用 vue.js 進行前端頁面的渲染
